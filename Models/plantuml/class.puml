@startuml
title Centralized medical management system - Class diagram
center footer Centralized medical management system - Class diagram

' TODO : Methods for each class.
' TODO : Add responsibilities? interfaces?
' TODO : clean up

class PatientRegistry {
+ search(idpatient : PatientID) : PatientFile
}
PatientRegistry o-> "*" PatientFile

interface Searchable {
+ search()
}
Searchable <|.. DoctorRegistry
Searchable <|.. PatientRegistry

class DoctorRegistry {
+ search(licenceNumber: String ) : Doctor
}
DoctorRegistry o--> "*" Doctor

class PatientFile{
     -String socialInsuranceNumber
     -int InsuranceNumberCode
'    -PatientID patientID
'    -MedicalVisits[] medicalVisits
'    -MedicalHistory[] medicalHistory

    'PRIVATE METHODS
    - consultPatientFile(user : User): PatientFile
    - cancelModifications()
}

abstract class User{
- String LastName
- String FirstName
{method} - getGender()
}

class RAMQ {
{method} +search(insurancenum : SocialInsuranceNumber)
- rebuildPatientFile(date : Date)

}

class SocialInsuranceNumber {
- String number
- Date birthday
- String lastName
- String firstName
{method} + getNumber()
}

RAMQ *->"*" SocialInsuranceNumber
Searchable <|... RAMQ
RAMQ ->"*" RAMQCode
RAMQ -->"*"PatientFile

class Patient{
{method}- add(info : ContactInformation)
-delete(info : ContactInformation)
}
PatientFile <- Patient

User <|-- Patient
User -->"1" ContactInformation


class HealthProfessional{
{method} - applyprescription()
}

User <|-- HealthProfessional

class MedicalEstablishment{

- String IdEstablishment
- String EstablishmentName

}
MedicalEstablishment ->"1" ContactInformation
Doctor ->"1" MedicalEstablishment

class MedicalHistory{
    -String diagnostic
    -String treatment
    -Doctor treatingDoctor
'    -DatePair datePair
{method} + getMedicalHistory()
}

class MedicalVisit{
    -MedicalEstablishment medicalEstablishment
    -Doctor seenDoctor
'   -Date visitDate
    -String diagnostic
    -String treatment
    -String visitSummary
    -String notes
{method} +getMedicalVisit()
}

class Doctor{
    -String licenceNumber
    -String specialty
    -String medicalEstablishment
{method}-modify(file : PatientFile)
-cancel( file : PatientFile)

}

class PatientID {
    -String lastName
    -String firstName
'    -Date dateOfBirth
    -String cityOfBirth
    -String[] knownParents
}

class ContactInformation {
    - number: int
    - street: String
    - city: String
    - postalCode: String
    - phone: String
    - email: String
'    + modifyContactInfo()
    - validatePhone(phone: String): boolean
    - validateEmail(email: String): boolean
    - validatePostalCode(code: String): boolean
}

'class Interface{
'}

class RAMQCode{
- String code
{method}-validateFormat(code: String): boolean
}

class Date{
    -String date
    -validateFormat(date: String): boolean
}

interface Modification {
+ Date date
{method}+modify()
+ cancel()

}
Modification <|. PatientFile

enum Gender{
    FEMALE,
    MALE,
    OTHER
}

'Interface -- Doctor
'Interface -- PatientFile

Doctor o--> "manages\r*" PatientFile
Doctor -|> User

PatientFile --> "1" PatientID
PatientFile *--> "0..*" MedicalHistory
PatientFile *--> "0..*" MedicalVisit

PatientID --> "1" Date
PatientID --> "1" RAMQCode
User --> "1" Gender

ContactInformation "1" <- PatientID

MedicalHistory --> "1..2" Date
MedicalVisit --> "1" Date

@enduml
